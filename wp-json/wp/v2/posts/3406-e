{"id":3406,"date":"2011-09-13T08:23:59","date_gmt":"2011-09-13T16:23:59","guid":{"rendered":"https:\/\/www.ultrasaurus.com\/?p=3406"},"modified":"2011-09-13T08:23:59","modified_gmt":"2011-09-13T16:23:59","slug":"upgrading-pie-from-rails-3-0-to-3-1","status":"publish","type":"post","link":"https:\/\/www.ultrasaurus.com\/2011\/09\/upgrading-pie-from-rails-3-0-to-3-1\/","title":{"rendered":"upgrading pie from rails 3.0 to 3.1"},"content":{"rendered":"<p>Whenever I upgrade Rails, I always start with &#8220;rails new&#8221; so that I get all the new config file goodness &#8212; I want to start fresh with whatever the new defaults are and then only make the modifications that I really want in my app.  Here&#8217;s the process I went through upgrading the pie &#8220;bakery&#8221; (a relative simple Rails 3.0 app) to Rails 3.1.<\/p>\n<p>First I moved my old app to a new name (since I want my new Rails app to have the same name internally as the old Rails app):<\/p>\n<pre>\nmv bakery bakery30\n<\/pre>\n<p>Now I set up a new gemset, so I&#8217;m starting fresh.  (My first attempt was to use my old gemset, but that showed me an old warning that I&#8217;d like to not bring forward, or at least isolate in the process of upgrading):<\/p>\n<pre>\nrvm use 1.9.2-p290\nrvm gemset create rails31\nrvm use 1.9.2-p290@rails31\n<\/pre>\n<p>Create the new app (specifying -T to create the app without test-unit, since I&#8217;m an <a href=\"https:\/\/www.relishapp.com\/rspec\">RSpec<\/a> fan)<\/p>\n<pre>\nrails new bakery -T\nmv bakery bakery 31\n<\/pre>\n<p>Now I edit my Gemfile to include the gems I want to bring over from my old app&#8230;<\/p>\n<pre>\ncd bakery\nvi Gemfile   \nbundle install\n<\/pre>\n<p>Then I want to re-generate rspec and cucumber config files and boilerplate<\/p>\n<pre>\nrails g rspec:install\nrails g cucumber:install\n<\/pre>\n<p>ok, now I have  vanilla Rails 3.1 app<br \/>\nI fetch my old app from github:<\/p>\n<pre>\ngit clone git@github.com:blazingcloud\/pie-bakery.git bakery\ncd bakery\n<\/pre>\n<p>and using the power of git, I&#8217;m going to remove all the old 3.0 code, add in my 3.1 app<\/p>\n<pre>\ngit rm -r *\ncp -r ..\/bakery31\/* .\ngit add .\n<\/pre>\n<p>Then I use gitx (a modern version like <a href=\"https:\/\/github.com\/brotherbard\/gitx\/downloads\">brotherbard<\/a>) to look at the changes and revert any deletes that are actually app code that I want to keep, review every diff, and hope that I&#8217;m paying close enough attention to everything (really wish I could be pairing on this).<\/p>\n<p>Now I set up my database and run my tests&#8230;  I don&#8217;t know why &#8220;rake test&#8221; doesn&#8217;t automatically run cucumber and rspec tests like it used to.  hmmm<\/p>\n<pre>\nrake db:schema:load\nrake cucumber\nrake spec\n<\/pre>\n<p>I realize that I missed a couple of diffs, rinse, repeat&#8230; when all is green I&#8217;m done.  Whew.<\/p>\n<p>I copy in my old .git\/config so I pull in my remote heroku repo config (which I&#8217;ve updated to <a href=\"http:\/\/devcenter.heroku.com\/articles\/cedar\">cedar stack<\/a>)<\/p>\n<pre>\ncp ..\/bakery30\/.git\/config .git\/config\n<\/pre>\n<p>and run rails<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Whenever I upgrade Rails, I always start with &#8220;rails new&#8221; so that I get all the new config file goodness &#8212; I want to start fresh with whatever the new defaults are and then only make the modifications that I really want in my app. Here&#8217;s the process I went through upgrading the pie &#8220;bakery&#8221;&hellip; <a href=\"https:\/\/www.ultrasaurus.com\/2011\/09\/upgrading-pie-from-rails-3-0-to-3-1\/\">Continue reading <span class=\"meta-nav\">&rarr;<\/span><\/a><\/p>\n","protected":false},"author":84,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[3],"tags":[],"_links":{"self":[{"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/posts\/3406"}],"collection":[{"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/users\/84"}],"replies":[{"embeddable":true,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/comments?post=3406"}],"version-history":[{"count":0,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/posts\/3406\/revisions"}],"wp:attachment":[{"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/media?parent=3406"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/categories?post=3406"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/tags?post=3406"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}