{"id":5160,"date":"2014-07-27T18:53:01","date_gmt":"2014-07-28T01:53:01","guid":{"rendered":"https:\/\/www.ultrasaurus.com\/?p=5160"},"modified":"2014-07-27T18:53:01","modified_gmt":"2014-07-28T01:53:01","slug":"time-tracking-google-calendar","status":"publish","type":"post","link":"https:\/\/www.ultrasaurus.com\/2014\/07\/time-tracking-google-calendar\/","title":{"rendered":"time tracking with google calendar"},"content":{"rendered":"<p>I just created a very lightweight time tracking system where we can use a Google Calendar to track who does what when and then get a spreadsheet that shows all of the hours worked by individuals.<\/p>\n<p>It goes with a spreadsheet where the first row has a header like this:<br \/>\nDate    Meeting Sarah   Paul    Glen<\/p>\n<p><a class=\"thumbnail\" href=\"https:\/\/www.ultrasaurus.com\/wp-content\/uploads\/2014\/07\/Screen-Shot-2014-07-27-at-6.47.14-PM.png\"><img loading=\"lazy\" src=\"https:\/\/www.ultrasaurus.com\/wp-content\/uploads\/2014\/07\/Screen-Shot-2014-07-27-at-6.47.14-PM.png\" alt=\"Screen Shot 2014-07-27 at 6.47.14 PM\" width=\"765\" height=\"219\" class=\"aligncenter size-full wp-image-5162\" srcset=\"https:\/\/www.ultrasaurus.com\/wp-content\/uploads\/2014\/07\/Screen-Shot-2014-07-27-at-6.47.14-PM.png 765w, https:\/\/www.ultrasaurus.com\/wp-content\/uploads\/2014\/07\/Screen-Shot-2014-07-27-at-6.47.14-PM-300x85.png 300w\" sizes=\"(max-width: 765px) 100vw, 765px\" \/><\/a><\/p>\n<p>The we just make events on Google calendar and invite whoever is working together at that time &#8212; could be a team meeting or one of us working on our own. Time will be tracked by first name of email address<br \/>\n(paul@whatever.com and paul@yahoo.com would all get tracked in the \u201cPaul\u201d column).  Currently the script doesn&#8217;t support two different people who share the same email name before &#8216;@&#8217;.<\/p>\n<p>You just have to fill in your calendar id, which you can find if you choose Calendar Settings and scroll to the bottom of the first page (in Calendar Address section).<\/p>\n<pre>\n\/\/ add menu\nfunction onOpen() {\n  var ss = SpreadsheetApp.getActiveSpreadsheet();\n  var menuEntries = [{name:\"Calculate Hours\", functionName: \"calculateHours\"}];\n  ss.addMenu(\"Hours\", menuEntries);\n  \/\/ calcular al iniciar\n  calculateHours();\n}\n \n\nfunction meetingSummary(cal_id){\n  var hours = 0;\n  var cal = CalendarApp.getCalendarById(cal_id);\n  Logger.log(cal);\n  Logger.log('The calendar is named \"%s\".', cal.getName());\n\n  var this_year = new Date(2013,0,1);\n  var now = new Date()\n  var events = cal.getEvents(this_year, now);\n  var results = []\n  \n  for ( i = 0 ; i &lt; events.length ; i++){\n    var event = events[i];\n    title = event.getTitle();\n    Logger.log(title);\n    var start = event.getStartTime() ;\n    var end =  event.getEndTime();\n    start = new Date(start);\n    end = new Date(end);\n    hours = ( end - start ) \/ ( 1000 * 60 * 60 );\n    guests = event.getGuestList();\n    \n    data = {meeting:title};\n    for (g in guests) {\n      var email = guests[g].getEmail();\n      var name = email.split(&#039;@&#039;)[0];\n      Logger.log(email, name);\n      data[name] = hours;\n    }\n    data[&#039;date&#039;] = start.toDateString();\n    results.push(data)\n  }\n  \n  Logger.log(results);\n  return results;\n}\n\nfunction calculateHours(){\n  Logger.clear();\n  Logger.log(&quot;calculateHours&quot;);\n  var cal_id = &quot;put your cal id here&quot;;\n  var ss = SpreadsheetApp.getActiveSpreadsheet();\n  var s = ss.getSheets()[0];\n  var headerValues = s.getRange(\"A1:F1\").getValues();\n  Logger.log(headerValues[0].length);\n  var columns = {}\n  var num_columns = headerValues[0].length;\n  for (i=0; i &lt; num_columns; i++) {\n    columns[headerValues[0][i].toLowerCase()] = i+1;\n  }\n  Logger.log(columns);\n  \/\/{&#039;glen&#039;:5, &#039;paul&#039;:4, &#039;description&#039;:6, &#039;meeting&#039;:2, &#039;sarah&#039;:3, &#039;date&#039;:1}\n  var title_column = 2;\n  \n  \/\/ from second row\n  var results = meetingSummary(cal_id);\n  Logger.log(&quot;results.length=&quot;+results.length);\n\n  for ( var row_number = 1; row_number &lt; results.length+1 ; row_number ++){\n    var result = results[row_number-1];\n    Logger.log(&quot;row_number=&quot;+row_number);\n    Logger.log(result);\n    for (name in columns) {\n      Logger.log(&quot;...&quot;+name+&quot;   &quot;+result[name]);\n      if (typeof result[name] == &#039;undefined&#039;) result[name] = &quot;&quot;;\n      s.getRange(row_number+1, columns[name]).setValue(result[name]);\n    }\n  }\n}\n<\/pre>\n","protected":false},"excerpt":{"rendered":"<p>I just created a very lightweight time tracking system where we can use a Google Calendar to track who does what when and then get a spreadsheet that shows all of the hours worked by individuals. It goes with a spreadsheet where the first row has a header like this: Date Meeting Sarah Paul Glen&hellip; <a href=\"https:\/\/www.ultrasaurus.com\/2014\/07\/time-tracking-google-calendar\/\">Continue reading <span class=\"meta-nav\">&rarr;<\/span><\/a><\/p>\n","protected":false},"author":84,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[2],"tags":[],"_links":{"self":[{"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/posts\/5160"}],"collection":[{"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/users\/84"}],"replies":[{"embeddable":true,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/comments?post=5160"}],"version-history":[{"count":0,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/posts\/5160\/revisions"}],"wp:attachment":[{"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/media?parent=5160"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/categories?post=5160"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/tags?post=5160"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}