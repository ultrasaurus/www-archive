{"id":2378,"date":"2010-01-27T00:00:12","date_gmt":"2010-01-27T08:00:12","guid":{"rendered":"https:\/\/www.ultrasaurus.com\/?p=2378"},"modified":"2015-04-10T11:26:15","modified_gmt":"2015-04-10T18:26:15","slug":"rails-security-review-checklist","status":"publish","type":"post","link":"https:\/\/www.ultrasaurus.com\/2010\/01\/rails-security-review-checklist\/","title":{"rendered":"rails security review checklist"},"content":{"rendered":"<p>I&#8217;m reviewing the security of a web app built with Ruby on Rails, so I put together a checklist for a security audit.  This isn&#8217;t a bank or high security situation, but there were a number of engineers and quite a bit of open source code, so I thought a few checks were in order.<\/p>\n<p>Here&#8217;s the list I came up with that I thought other folks might appreciate as a starting point (special thanks to the sfruby list, <a href=\"http:\/\/afreshcup.com\/\">Mike Gunderloy<\/a>, and Scott Bronson for feedback):<\/p>\n<p>0) Make sure your Rails and gems are up to date for latest security patches (see <a href=\"http:\/\/groups.google.com\/group\/rubyonrails-security\">rails security mailing list<\/a> for recent advisory notes)<\/p>\n<p>1) Active Record audit:<br \/>\n&nbsp;&nbsp;A) SQL injection:<br \/>\n&nbsp;&nbsp;&nbsp;&nbsp;(i) whole word search for &#8220;find&#8221;, &#8220;first&#8221;, and &#8220;all&#8221; then visually inspect all instances of ActiveRecord find calls for potential SQL injection vulnerability (also search for &#8220;sql&#8221; not whole work search to find find_by_sql and &#8220;execute&#8221; to find cases where raw sql is executed.<br \/>\n&nbsp;&nbsp;&nbsp;&nbsp;(ii) search your models for &#8220;named_scope&#8221; and check :conditions<br \/>\n&nbsp;&nbsp;B) check for <a href=\"http:\/\/railspikes.com\/2008\/9\/22\/is-your-rails-application-safe-from-mass-assignment\">mass assignment<\/a>  Either disable mass assignment as Eric suggests in his article, or audit its use.  If doing an audit, check every model to make sure it declares which attributes are settable with attr_accessible.  (While attr_protected may technically work, a white list approach is recommended by security experts and the <a href=\"http:\/\/groups.google.com\/group\/rubyonrails-security\/browse_thread\/thread\/42c4d5d3b7354735\">rails security advisory<\/a> on this topic)<\/p>\n<p>2) Scripting attack: search all eRB files for &lt;%= and ensure that if dynamically generated text was originally entered by the user, it is HTML escaped. Consider <a href=\"http:\/\/github.com\/nzkoz\/rails_xss\">rails_xss<\/a><\/p>\n<p>3) Secure Access: If some of the site does not have public access, check controllers and ensure that public actions are specifically allowed and that protected access is the default<\/p>\n<p>4) search for &#8220;eval&#8221; (whole word) and verify that usages are safe<\/p>\n<p>5) search for &#8220;forgery&#8221; (not whole word), make sure that<br \/>\nconfig.action_controller.allow_forgery_protection    = false<br \/>\nis only disabled in test config<br \/>\n protect_from_forgery should be in the ApplicationController, unless there is a good reason for it not to be<\/p>\n<p>6) check user auth and review that controller actions are limited to expected use<\/p>\n<p>7) passwords: not saved as clear-text in the db, not logged<\/p>\n<p>8) check that private data is not stored in cookies <\/p>\n","protected":false},"excerpt":{"rendered":"<p>I&#8217;m reviewing the security of a web app built with Ruby on Rails, so I put together a checklist for a security audit. This isn&#8217;t a bank or high security situation, but there were a number of engineers and quite a bit of open source code, so I thought a few checks were in order.&hellip; <a href=\"https:\/\/www.ultrasaurus.com\/2010\/01\/rails-security-review-checklist\/\">Continue reading <span class=\"meta-nav\">&rarr;<\/span><\/a><\/p>\n","protected":false},"author":84,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[2],"tags":[],"_links":{"self":[{"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/posts\/2378"}],"collection":[{"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/users\/84"}],"replies":[{"embeddable":true,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/comments?post=2378"}],"version-history":[{"count":0,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/posts\/2378\/revisions"}],"wp:attachment":[{"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/media?parent=2378"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/categories?post=2378"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.ultrasaurus.com\/wp-json\/wp\/v2\/tags?post=2378"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}